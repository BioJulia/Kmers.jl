<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>K-mer replacements · Kmers.jl</title><meta name="title" content="K-mer replacements · Kmers.jl"/><meta property="og:title" content="K-mer replacements · Kmers.jl"/><meta property="twitter:title" content="K-mer replacements · Kmers.jl"/><meta name="description" content="Documentation for Kmers.jl."/><meta property="og:description" content="Documentation for Kmers.jl."/><meta property="twitter:description" content="Documentation for Kmers.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Kmers.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Kmers.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../kmers/">The Kmer type</a></li><li><a class="tocitem" href="../iteration/">Iteration</a></li><li><a class="tocitem" href="../translation/">Translation</a></li><li><a class="tocitem" href="../hashing/">Hashing</a></li><li class="is-active"><a class="tocitem" href>K-mer replacements</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Example:-Minimizers"><span>Example: Minimizers</span></a></li></ul></li><li><a class="tocitem" href="../faq/">FAQ</a></li><li><span class="tocitem">Cookbook</span><ul><li><a class="tocitem" href="../minhash/">MinHash</a></li><li><a class="tocitem" href="../composition/">Kmer composition</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>K-mer replacements</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>K-mer replacements</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/BioJulia/Kmers.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/BioJulia/Kmers.jl/blob/master/docs/src/replacements.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="replacements"><a class="docs-heading-anchor" href="#replacements">Building kmer replacements</a><a id="replacements-1"></a><a class="docs-heading-anchor-permalink" href="#replacements" title="Permalink"></a></h1><p><em>Kmer replacements</em> is the general term for sequences that can be represented computationally like kmers, but are sampled differently. Examples include minimizers, strobemers, syncmers and k-min-mers.</p><p>Since there is no end to the variations of kmer replacements, Kmers.jl does not try to implement all of them. Instead, Kmers.jl implements the base kmer type, and exposes some efficient primitives to allow downstream users to build kmer replacements.</p><p>These functions are:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kmers.unsafe_extract" href="#Kmers.unsafe_extract"><code>Kmers.unsafe_extract</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unsafe_extract(::RecodingScheme, T::Type{&lt;:Kmer}, seq, from::Int) -&gt; T</code></pre><p>Extract a <code>Kmer</code> of type <code>T</code> from <code>seq</code> beginning at index <code>from</code>. This function is useful to create kmer or kmer-like types.</p><p>This function does not do any bounds checking, so the user must know that <code>from:from+K-1</code> is inbounds in <code>seq</code>. The validity of the data in the <code>seq</code> is validated by this function.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; seq = b&quot;TAGCTAGA&quot;;

julia&gt; Kmers.unsafe_extract(Kmers.AsciiEncode(), DNAKmer{4, 1}, seq, 2)
DNA 4-mer:
AGCT</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BioJulia/Kmers.jl/blob/48f87f515b226046b3f768f8f7195b224f6c8347/src/construction_utils.jl#L8-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kmers.shift_encoding" href="#Kmers.shift_encoding"><code>Kmers.shift_encoding</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">shift_encoding(kmer::T, encoding::UInt) where {T &lt;: Kmer} -&gt; T</code></pre><p>Add <code>encoding</code>, a valid encoding in the alphabet of the <code>kmer</code>, to the end of <code>kmer</code> and discarding the first symbol in <code>kmer</code>.</p><p>It is the user&#39;s responsibility to ensure that <code>encoding</code> is valid.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; enc = UInt(0x0a); # encoding of DNA_Y in 4-bit alphabets

julia&gt; kmer = Kmer{DNAAlphabet{4}, 4}(&quot;TAGA&quot;);

julia&gt; Kmers.shift_encoding(kmer, enc)
DNA 4-mer:
AGAY</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BioJulia/Kmers.jl/blob/48f87f515b226046b3f768f8f7195b224f6c8347/src/construction_utils.jl#L110-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kmers.unsafe_shift_from" href="#Kmers.unsafe_shift_from"><code>Kmers.unsafe_shift_from</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unsafe_shift_from(::RecodingScheme, kmer::T, seq, from::Int, ::Val{S}) -&gt; T</code></pre><p>Extract <code>S::Int</code> symbols from sequence <code>seq</code> at positions <code>from:from+S-1</code>, and shift them into <code>kmer</code>.</p><p>This function does not do any bounds checking, so it is the user&#39;s responsibility to ensure that <code>from</code> is inbounds, and the recoding scheme valid. It is assumed that <code>S &lt; K</code>, where <code>K == length(kmer)</code>. If <code>S ≥ K</code>, use <a href="#Kmers.unsafe_extract"><code>unsafe_extract</code></a> instead.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; seq = dna&quot;TAGCGGA&quot;;

julia&gt; kmer = mer&quot;GGTG&quot;d;

julia&gt; Kmers.unsafe_shift_from(Kmers.FourToTwo(), kmer, seq, 3, Val(2))
DNA 4-mer:
TGGC</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BioJulia/Kmers.jl/blob/48f87f515b226046b3f768f8f7195b224f6c8347/src/construction_utils.jl#L138-L160">source</a></section></article><h1 id="Example:-Minimizers"><a class="docs-heading-anchor" href="#Example:-Minimizers">Example: Minimizers</a><a id="Example:-Minimizers-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Minimizers" title="Permalink"></a></h1><p>Minimizers are currently the most common kmer replacement. They are defined as the minimum of W consecutive kmers, as ordered by some ordering O.</p><p>If we use <a href="../hashing/#Kmers.fx_hash"><code>fx_hash</code></a> as the ordering function, and assume K and W are known at compile time, we can implement it reasonably efficiently like so:</p><pre><code class="language-julia hljs">function unsafe_extract_minimizer(
    seq::LongDNA{2},
    i::Int,
    ::Val{K},
    ::Val{W},
) where {K, W}
    T = derive_type(Kmer{DNAAlphabet{2}, K})
    kmer = Kmers.unsafe_extract(Kmers.Copyable(), T, seq, i)
    hash = fx_hash(kmer)
    for offset in 0:W-2
        new_kmer = Kmers.unsafe_shift_from(Kmers.Copyable(), kmer, seq, i+K+offset, Val(1))
        new_hash = fx_hash(new_kmer)
        if new_hash &lt; hash
            hash = new_hash
            kmer = new_kmer
        end
    end
    kmer
end

rng = Random.Xoshiro(1)
unsafe_extract_minimizer(randseq(rng, DNAAlphabet{2}(), 100), 1, Val(5), Val(9))

# output
DNA 5-mer:
TATCA</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../hashing/">« Hashing</a><a class="docs-footer-nextpage" href="../faq/">FAQ »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Tuesday 3 June 2025 07:24">Tuesday 3 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
